<!DOCTYPE html>
<html lang="de">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>01p-w</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#000000">
  <meta content="01p-w is the outcome of an in-depth research about the essence of photography, its influence on the construction of identity and the instruments for archiving imagery
	in the past and athe present. 01p-w is neither a further social network nor another app to publicly exhibit your private photos – 01p-w does just the opposite. It stands
	for radical limitation in a world of unlimited noise, for a conscious engagement with photography; a medium once a word of almost magical properties described as an
	emanation of reality." name="description">
  <meta content="01p-w" name="author">
  <meta content="http://01p-w.com/img/fb.png" property="og:image">
  <meta content="01p-w" property="og:title">
  <meta content="http://01p-w.com" property="og:url">
  <meta content="01p-w is the outcome of an in-depth research about the essence of photography, its influence on the construction of identity and the instruments for archiving imagery
	in the past and the present. 01p-w is neither a further social network nor another app to publicly exhibit your private photos – 01p-w does just the opposite. It stands
	for radical limitation in a world of unlimited noise, for a conscious engagement with photography; a medium once a word of almost magical properties described as an
  emanation of reality." property="og:description">
  <link href="./css/style.css" rel="stylesheet">
  <link href="./favicon.png" rel="shortcut icon">
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.11/handlebars.runtime.min.js"></script>
  <script src="./js/templates/templates.js"></script>
  <script defer src="./js/fullscreen.js"></script>

  <!-- update the version number as needed -->
  <script defer src="/__/firebase/5.2.0/firebase-app.js"></script>
  <!-- include only the Firebase features as you need -->
  <script defer src="/__/firebase/5.2.0/firebase-auth.js"></script>
  <script defer src="/__/firebase/5.2.0/firebase-storage.js"></script>
  <script defer src="/__/firebase/5.2.0/firebase-firestore.js"></script>
  <!-- initialize the SDK after all desired features are loaded -->
  <script defer src="/__/firebase/init.js"></script>
</head>

<body>
  <header>
    <h1 id="logo">
      <a href="/" alt="Home">01p-w</a>
    </h1>
    <h1 id="user" class="hidden"></h1>
    <h1 id="logout" class="hidden">
      <a href="" onclick="signOut()">Logout</a>
    </h1>
  </header>
  <div id="loginfield" class="up">
    <div id="lfield">
      <div id="closecross">
        <a href="" onclick="return false">
          <img src="img/greycross.png" />
        </a>
      </div>
      <form name="login" id="loginform" onsubmit="signIn(event)">
        <table>
          <tr>
            <td>Email
              <br>
              <input id="login_email" type="email" name="email" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"
                required="true">
            </td>
          </tr>
          <tr>
            <td>Password
              <br>
              <input id="login_password" type="password" name="password" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"
                required="true">
            </td>
          </tr>
          <tr>
            <td>
              <div id="rememberme" class="checkbox">

                <input type="checkbox" id="rememberme" name="rememberme" />
                <label for="rememberme">
                  Remember me</label>
              </div>
              <div class="submit">
                <input type="submit" class="submitbutton" value="Login">
              </div>
            </td>
          </tr>
        </table>
      </form>
    </div>
    <div id="rfield">
      <form name="registration" id="registrationform" onsubmit="signUp(event)">

        <table>
          <tr>
            <td>
              <h2>Create an account</h2>
            </td>
          </tr>
          <tr>
            <td>First name
              <br>
              <input type="text" name="firstname" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" required="true">
            </td>
          </tr>
          <tr>
            <td>Last name
              <br>
              <input type="text" name="lastname" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" required="true">
            </td>
          </tr>
          <tr>
            <td>Email
              <br>
              <input type="email" name="email" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" required="true">
            </td>
          </tr>
          <tr>
            <td>Confirm email
              <br>
              <input type="email" name="confirmemail" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" required="true">
            </td>
          </tr>
          <tr>
            <td>Password
              <br>
              <input type="password" name="password" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" required="true">
            </td>
          </tr>
          <tr>
            <td>Confirm password
              <br>
              <input type="password" name="confirmpassword" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"
                required="true">
            </td>
          </tr>
          <tr>
            <td>
              <div id="policy" class="checkbox">
                <input type="checkbox" id="policy" name="policy" />
                <label for="policy">
                  I accept and have read the privacy
                  <br>policy and the membership policy.</label>
              </div>
              <div class="submit">
                <input type="submit" class="submitbutton" value="Sign up">
              </div>
            </td>
          </tr>
        </table>

      </form>
    </div>
  </div>
  <footer>
    <div id="captionbar">
      <span id="all">All</span>
      <span id="yearfull">
        2018</span>
      <span id="view">View</span>
      <span id="save">Save</span>
      <span id="download">Download</span>
      <span id="quit">
        <a href="/2018/01" alt="Quit">Quit</a>
      </span>
    </div>
    <ul class="dropdown" id="year">
      <a href="https://01p-w.com/2016" alt="2016">
        <li>2016</li>
      </a>
      <a href="https://01p-w.com/2017" alt="2017">
        <li>2017</li>
      </a>
      <a href="https://01p-w.com/2018" alt="2018">
        <li>2018</li>
      </a>
    </ul>
    <ul class="dropdown" id="downloadtype">
      <a href="https://01p-w.com/media/collection.zip" target="_blank" rel="noopener" alt="Print">
        <li>Print</li>
      </a>
      <a href="https://01p-w.com/media/collection.zip" target="_blank" rel="noopener" alt="Desktop">
        <li>Desktop</li>
      </a>
      <a href="https://01p-w.com/media/collection.zip" target="_blank" rel="noopener" alt="Mobile">
        <li>Mobile</li>
      </a>
    </ul>

  </footer>
  <div id="gallery" class="hidden">
    <!--template defined in ./js/templates/image.handlebars will be inserted here-->
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      try {
        let app = firebase.app();
        const firestore = firebase.firestore();
        const settings = { timestampsInSnapshots: true };
        firestore.settings(settings);
        // const email = "oliver.kerrison@neusicht.ch";
        // const password = "onepasswordperweek";
        // const displayName = "Oliver Kerrison";
        // signIn(email, password);

        firebase.auth().onAuthStateChanged(function (user) {
          if (user) {
            toggleUI();
            if (user.displayName) {
              document.querySelector("#user").textContent = user.displayName;
            } else {
              user.updateProfile({
                displayName: displayName
              }).then(function () {
                document.querySelector("#user").textContent = user.displayName;
              });
            }
            getImagesByUserId(user.uid);
          }
        });

      } catch (e) {
        console.error(e);
      }
    });

    function signIn(event) {
      event.preventDefault();
      const email = document.querySelector("#login_email").value;
      const password = document.querySelector("#login_password").value;
      firebase.auth().signInWithEmailAndPassword(email, password).catch(function (error) {
        console.error(`(signIn): (${error.code}) ${error.message}`)
      });
    }

    function signOut() {
      firebase.auth().signOut().then(function () {
        toggleUI();
      });
    }

    function signUp(event) {
      event.preventDefault();
      if (validateSignUpForm(form)) {
        firebase.auth().createUserWithEmailAndPassword(form.email.value, form.password.value).catch(function (error) {
          console.error(`(signUp): (${error.code}) ${error.message}`)
        });
      }
    }

    function validateSignUpForm(form) {
      // Todo implement validation and errors
      return true;
    }

    function toggleUI() {
      document.querySelector("#user").classList.toggle("hidden");
      document.querySelector("#logout").classList.toggle("hidden");
      document.querySelector("#loginfield").classList.toggle("hidden");
      document.querySelector("#gallery").classList.toggle("hidden");
    }

    function getImagesByUserId(userId) {
      firebase.firestore().collection("images").where("uid", "==", userId).onSnapshot(function (querySnapshot) {
        let images = [];
        querySnapshot.forEach((doc) => {
          images.push(doc.data());
        });
        images.sort(((a, b) => parseInt(a.label) - parseInt(b.label)));
        const context = { images: images };
        document.querySelector("#gallery").innerHTML = Handlebars.templates.image(context);
        addAnimation();
      });
    }

    function addAnimation() {
      $(".currentweek").click(function () {
        $("#week").toggleClass("visible");
      });
      $("#gallery .image").click(function () {
        $(this).toggleClass("active");
        $(this).toggleClass("inactive");
      });
      $("#waitinglist a").click(function () {
        $("#loginfield")
          .addClass("down")
          .removeClass("up");
      });
      $("#loginfield #closecross").click(function () {
        $("#loginfield")
          .addClass("up")
          .removeClass("down");
      });
      $(".currentyear, #yearfull").click(function () {
        $("#year").toggleClass("visible");
      });
      $("#download").click(function () {
        $("#downloadtype").toggleClass("visible");
      });
      $("#view").click(function () {
        $(".inactive").hide();
      });
      $("#all").click(function () {
        $(".inactive").show();
        $("#gallery .image").addClass("inactive");
        $("#gallery .image").removeClass("active");
      });
      document.querySelector(".fullscreen").addEventListener("click", () => {
        if (screenfull.enabled) {
          screenfull.request();
          $("header, footer, .captionbar").addClass("invisible");
          $("article").addClass("fullsize");
        } else {
        }
      });

      document.querySelector(".cross").addEventListener("click", () => {
        if (screenfull.enabled) {
          screenfull.exit();
          $("header, footer, .captionbar").removeClass("invisible");
          $("article").removeClass("fullsize");
        } else {
        }
      });
    }
    // Check that service workers are registered
    // if ('serviceWorker' in navigator) {
    //   // Use the window load event to keep the page load performant
    //   window.addEventListener('load', () => {
    //     navigator.serviceWorker.register('/sw.js');
    //   });
    // }
  </script>
  <script type="application/javascript"> var piioData = { appKey: 'sgnclp', encodeSrc: false, domain: 'https://beta.01p-w.com' } </script>
  <script src="https://js.piio.co/sgnclp/piio.min.js"></script>
</body>

</html>